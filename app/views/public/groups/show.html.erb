<div class="container">
  <div class="row">
    <div class="col">
      <%= image_tag @group.get_group_image(300,300) %><br>
      グループ名: <%= @group.name %><br>
      グループ紹介文:<%= @group.introduction %><br>
      グループオーナー: <%= @group.owner.name %><br>
      グループメンバー数： <%= @group.group_members.count %> <br>

      <% unless @group.owner_id == current_user.id %>
        <% if @group.group_member?(current_user)%>
          <%= link_to 'グループ退会', group_group_members_path(@group), method: :delete, class: "btn btn-sm btn-danger", data: { confirm: "本当にグループを退会しますか？" } %>
        <% elsif @group.group_join_requests.exists?(user_id: current_user.id) %> <%# useridがデータベース(group_join_requests)内に存在しているか判定 %>
          <%= link_to 'グループ加入申請取消',  group_group_join_requests_path(@group), method: :delete, class: "btn btn-sm btn-danger" %>
        <% else %>
          <%= link_to 'グループ加入申請',  group_group_join_requests_path(@group), method: :post, class: "btn btn-sm btn-success" %>
        <% end %>
      <% end %>

      <%# グループオーナー用 %>
      <% if @group.owner_id == current_user.id %>
        <%= link_to "編集", edit_group_path(@group), class: "btn btn-sm btn-success" %>
        <%= link_to "承認待ち一覧", display_join_requests_path(@group),  class: "btn btn-sm btn-success" %> 
      <% end %>

      <%# グループ参加済みユーザー一覧表示 %>
      <% @group.users.each do |user| %>
        <li style="list-style: none;"><%= user.name %></li>
      <% end %>
    </div>
  </div>
</div>